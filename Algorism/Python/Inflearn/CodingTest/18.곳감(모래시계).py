# 곳감(모래시계)
'''
현수는 곳감을 만들기 위해 감을 깍아 마당에 말리고 있습니다. 
현수의 마당은 N*N 격자판으로 이루어져 있으며, 현수는 각 격자단위로 말리는 감의 수를 정합니다. 
그런데 해의 위치에 따라 특정위치의 감은 잘 마르지 않습니다. 
그래서 현수는 격자의 행을 기준으로 왼쪽, 또는 오른쪽으로 회전시켜 위치를 변경해 모든 감이 잘 마르게 합니다.
만약 회전명령 정보가 2 0 3이면 2번째 행을 왼쪽으로 3만큼 아래 그림처럼 회전시키는 명령입니다. 

첫 번째 수는 행번호, 두 번째 수는 방향인데 0이면 왼쪽, 1이면 오른쪽이고, 세 번째 수는 회전하는 격자의 수입니다. 
M개의 회전명령을 실행하고 난 후 아래와 같이 마당의 모래시계 모양의 영역에는 감 이 총 몇 개가 있는지 출력하는 프로그램을 작성하세요.

 ▣ 입력설명
첫 줄에 자연수 N(3<=N<=20) 이 주어며, N은 홀수입니다.
두 번째 줄부터 N줄에 걸쳐 각 줄에 N개의 자연수가 주어진다. 
이 자연수는 각 격자안에 있는 감의 개수이며, 각 격자안의 감의 개수는 100을 넘지 않는다.
그 다음 줄에 회전명령의 개수인 M(1<=M<=10)이 주어지고, 그 다음 줄부터 M개의 회전명령 정보가 M줄에 걸쳐 주어집니다.

 ▣출력설명
총 감의 개수를 출력합니다.
'''

matrix = [
    [10, 13, 10, 12, 15],
    [12, 39, 30, 23, 11],
    [11, 25, 50, 53, 15],
    [19, 27, 29, 37, 27],
    [19, 13, 30, 13, 19],
]

def solution(matrix, rotates):
    """
    matrix : N x N 격자(2차원 리스트)
    rotates: 회전 명령 리스트 [ [행번호, 방향, 칸수], ... ]
             - 행번호: 1 ~ N (문제 기준)
             - 방향: 0=왼쪽(left), 1=오른쪽(right)
             - 칸수: 회전할 cell 수
    반환값 : 모래시계 영역에 있는 값들의 총합
    """
    n = len(matrix)          # N (행/열 개수, 정사각형이므로 동일)

    # ----------------------------------------------------
    # 1. 모든 회전 명령을 순서대로 적용
    # ----------------------------------------------------
    for row_num, direction, rot_cnt in rotates:
        row_idx = row_num - 1        # 문제는 1번 행부터 시작 → 파이썬은 0번 인덱스이므로 -1
        rot = rot_cnt % n            # n번 이상 돌리면 제자리이므로, n으로 나눈 나머지만 의미 있음

        # 현재 행(row) 가져오기
        row = matrix[row_idx]

        if direction == 0:           # 왼쪽 회전 (left rotation)
            # 예: [1,2,3,4,5], rot=2 → [3,4,5,1,2]
            matrix[row_idx] = row[rot:] + row[:rot]

        elif direction == 1:         # 오른쪽 회전 (right rotation)
            # 예: [1,2,3,4,5], rot=2 → [4,5,1,2,3]
            matrix[row_idx] = row[-rot:] + row[:-rot]

        else:
            # 문제 조건(0 또는 1) 이외 값이 들어오면 에러 처리
            return "잘못된 회전 방향입니다."

    # ----------------------------------------------------
    # 2. 모래시계 형태(hourglass shape)의 총합 구하기
    #    - N은 홀수
    #    - i=0행: 전체 0~N-1열
    #    - 아래로 내려가며 양쪽에서 한 칸씩 줄다가
    #      중앙(i=N//2) 이후 다시 양쪽으로 넓어짐
    # ----------------------------------------------------
    s, e = 0, n - 1   # s = 시작 column index, e = 끝 column index
    result = 0

    for i in range(n):          # i = 행 인덱스 (0 ~ N-1)
        # 현재 행에서 s열부터 e열까지 더하기
        for j in range(s, e + 1):
            result += matrix[i][j]

        # 위쪽 절반(0 ~ N//2 - 1): 점점 좁아짐
        # 가운데 행(i == N//2) 이후: 다시 넓어짐
        if i < n // 2:
            s += 1       # 왼쪽에서 한 칸 안쪽으로
            e -= 1       # 오른쪽에서 한 칸 안쪽으로
        else:
            s -= 1       # 왼쪽을 다시 바깥쪽으로
            e += 1       # 오른쪽을 다시 바깥쪽으로

    return result

print(solution(matrix, [[2, 0, 3], [5, 1, 2], [3, 1, 4]]))
